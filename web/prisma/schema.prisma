generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("SUPABASE_DATABASE_URL")
}

enum Role {
  Admin
  Organizer
  Leader
  Froshee
}

enum Interest {
  Travel
  Outdoors
  Adventure
  Hiking
  Fishing
  Hunting
  Camping
  Beach
  Music
  Books
  Gaming
  Netflix
  Movies
  Writing
  Concerts
  Cooking
  Beer
  Food
  Wine
  Pizza
  Coffee
  Sports
  Gym
  Walks
  Fitness
  Dancing
  Football
  Basketball
  Baseball
  Hockey
  Pets
}

model University {
  // id
  id String @id @default(uuid())

  // attributes
  name      String @unique
  subdomain String @unique

  // associations
  programs     Program[]
  froshs       Frosh[]
  profiles     Profile[]
  resourceTags ResourceTag[]
  offers       Offer[]

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Program {
  // id
  id String @id @default(uuid())

  // attributes
  name     String
  profiles Profile[]

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId String

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Frosh {
  // id
  id String @id @default(uuid())

  // attributes
  name        String
  description String
  ticketPrice Int

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId String

  events       Event[]
  teams        Team[]
  profiles     Profile[]
  Notification Notification[]

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // constraints
  @@unique([name, universityId]) // froshs in the same university cannot have the same name
}

model Event {
  // id
  id String @id @default(uuid())

  // attributes
  name          String
  description   String
  startDate     DateTime
  endDate       DateTime
  location      String
  accessibility String

  // associations
  frosh   Frosh  @relation(fields: [froshId], references: [id])
  froshId String

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Team {
  // id
  id String @id @default(uuid())

  // attributes
  name String

  // associations
  frosh   Frosh  @relation(fields: [froshId], references: [id])
  froshId String

  profiles     Profile[]
  Notification Notification[]

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Profile {
  // id
  id String @id @default(uuid())

  // attributes
  name        String
  email       String     @unique
  phoneNumber String     @unique
  role        Role
  paid        Int?
  interests   Interest[]

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId String

  program   Program? @relation(fields: [programId], references: [id])
  programId String? // optional because admin/organizers are not part of a program

  frosh   Frosh?  @relation(fields: [froshId], references: [id]) // optional because admin/organizers are not part of a frosh
  froshId String?

  team   Team?   @relation(fields: [teamId], references: [id]) // optional because admin/organizers are not part of a team
  teamId String?

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ResourceTag {
  // id
  id String @id @default(uuid())

  // attributes
  name String
  icon String

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId String

  resources Resource[]

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // constraints
  @@unique([name, universityId]) // tags in the same university cannot have the same name
}

model Resource {
  // id
  id String @id @default(uuid())

  // attributes
  title       String
  description String
  phoneNumber String?
  email       String?

  // associations
  resourceTag   ResourceTag @relation(fields: [resourceTagId], references: [id])
  resourceTagId String

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Offer {
  // id
  id String @id @default(uuid())

  // attributes
  title       String
  description String
  location    String
  provider    String
  icon        String
  color       String

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId String

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Notification {
  // id
  id String @id @default(uuid())

  // attributes
  title String
  body  String

  // associations
  frosh   Frosh?  @relation(fields: [froshId], references: [id])
  froshId String?

  team   Team?   @relation(fields: [teamId], references: [id])
  teamId String?

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
