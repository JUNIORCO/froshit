generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("SUPABASE_DATABASE_URL")
}

enum Role {
  Admin
  Organizer
  Leader
  Froshee
}

enum Interest {
  Travel
  Outdoors
  Adventure
  Hiking
  Fishing
  Hutning
  Camping
  Beach
  Music
  Books
  Gaming
  Netflix
  Movies
  Writing
  Concerts
  Cooking
  Beer
  Food
  Wine
  Pizza
  Coffee
  Sports
  Gym
  Walks
  Fitness
  Dancing
  Football
  Basketball
  Baseball
  Hockey
  Pets
}

model University {
  // id
  id        Int    @id @default(autoincrement())
  // attributes
  name      String @unique
  subdomain String @unique
  imageUrl  String

  // associations
  programs     Program[]
  froshs       Frosh[]
  profiles     Profile[]
  resourceTags ResourceTag[]
  offers       Offer[]

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Program {
  // id
  id Int @id @default(autoincrement())

  // attributes
  name     String
  profiles Profile[]

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId Int

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Frosh {
  // id
  id Int @id @default(autoincrement())

  // attributes
  name        String
  description String
  imageUrl    String
  ticketPrice Int

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId Int

  events   Event[]
  teams    Team[]
  profiles Profile[]

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // constraints
  @@unique([name, universityId]) // froshs in the same university cannot have the same name
}

model Event {
  // id
  id Int @id @default(autoincrement())

  // attributes
  name          String
  description   String
  startDate     DateTime
  endDate       DateTime
  imageUrl      String
  location      String
  accessibility String

  // associations
  frosh   Frosh @relation(fields: [froshId], references: [id])
  froshId Int

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Team {
  // id
  id Int @id @default(autoincrement())

  // attributes
  name String

  // associations
  frosh   Frosh @relation(fields: [froshId], references: [id])
  froshId Int

  profiles Profile[]

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Profile {
  // id
  id Int @id @default(autoincrement())

  // attributes
  name        String
  email       String     @unique
  phoneNumber String     @unique
  role        Role
  avatarUrl   String
  paid        Int?
  interests   Interest[]

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId Int

  program   Program? @relation(fields: [programId], references: [id])
  programId Int? // optional because admin/organizers are not part of a program

  frosh   Frosh? @relation(fields: [froshId], references: [id]) // optional because admin/organizers are not part of a frosh
  froshId Int?

  team   Team? @relation(fields: [teamId], references: [id]) // optional because admin/organizers are not part of a team
  teamId Int?

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ResourceTag {
  // id
  id Int @id @default(autoincrement())

  // attributes
  name String
  icon String

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId Int

  resources Resource[]

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // constraints
  @@unique([name, universityId]) // tags in the same university cannot have the same name
}

model Resource {
  // id
  id Int @id @default(autoincrement())

  // attributes
  title       String
  description String

  // associations
  resourceTag   ResourceTag @relation(fields: [resourceTagId], references: [id])
  resourceTagId Int

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Offer {
  // id
  id Int @id @default(autoincrement())

  // attributes
  title       String
  description String
  provider    String
  icon        String
  colour      String

  // associations
  university   University @relation(fields: [universityId], references: [id])
  universityId Int

  // dates
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
